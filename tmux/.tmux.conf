# QiangZiBroçš„tmuxé…ç½®
#	Github:https://github.com/QiangZiBro

#--------------------------------------------------------------------------------
# åŸºæœ¬é…ç½®
#	refer: https://github.com/tmux-plugins/tmux-sensible
#		   https://github.com/samoshkin/tmux-config
#			
#--------------------------------------------------------------------------------


#-------------------------------------------------
# é€‰é¡¹(Options)
#-------------------------------------------------

# è®¾ç½®æœ¬åœ°<prefix>ä¸º Ctrl+S ç»„åˆé”®
unbind C-b
set -g prefix C-s
# è®¾ç½®è¿œç¨‹<prefix>ä¸º Ctrl+B ç»„åˆé”®ï¼Œåœ¨åµŒå¥—tmuxæœ‰ç”¨
bind-key -n C-r send-prefix

# å…è®¸ä½¿ç”¨é¼ æ ‡ä¸Šä¸‹æ»‘åŠ¨ï¼Œæ”¹å˜çª—æ ¼å¤§å°ï¼Œé€‰æ‹©çª—å£
# refer: https://davidverhasselt.com/enable-mouse-support-in-tmux-on-os-x/
set -g mouse on
## TODO
#if-shell -b 'test "$(uname)" = "Darwin"' "\
#	set -g mouse-resize-pane on;\
#	set -g mouse-select-pane on;\
#	set -g mouse-select-window on;\
#"

# tmuxä¸­ç¿»é¡µå¤åˆ¶æ—¶ï¼Œç”¨vimçš„å¿«æ·é”®
setw -g mode-keys vi

# å¢åŠ å†å²å®¹é‡
set -g history-limit 50000

# TODO
set -g default-terminal "screen-256color"
#-------------------------------------------------
# å¿«æ·é”®(Key bindings)
#-------------------------------------------------
# åœ¨å½“å‰ç›®å½•ä¸‹æ‰“å¼€æ–°çš„ç»ˆç«¯
bind c new-window -c "#{pane_current_path}"
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# ä½¿ç”¨vimé”®é€‰çª—æ ¼ï¼ˆpaneï¼‰
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# ä½¿ç”¨<prefix>+ Ctrl+Pæˆ–Ctrl+Nè¿›å…¥ä¸Šä¸€ä¸ªå’Œä¸‹ä¸€ä¸ªçª—å£
# ã€æç¤ºã€‘ï¼šæŒ‰ä½ctrlï¼ŒæŒ‰sï¼ŒæŒ‰på°±å¯ä»¥è¿›å…¥ä¸Šä¸€çª—å£
bind C-p previous-window
bind C-n next-window

#--------------------------------------------------------------------------------
# Githubæ’ä»¶
#--------------------------------------------------------------------------------
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# æ”¯æŒæ­£åˆ™æœç´¢ï¼Œprefix + /ï¼Œæ›´å¤šå‚è€ƒhttps://github.com/tmux-plugins/tmux-copycat
set -g @plugin 'tmux-plugins/tmux-copycat'

#set -g @plugin 'odedlaz/tmux-onedark-theme'

#-------------------------------------------------
# çŠ¶æ€æ (Status Bar)
#-------------------------------------------------
# æ˜¾ç¤ºprefixé”®æœ‰æ²¡æœ‰è¢«æŒ‰ä¸‹
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

# æ˜¾ç¤ºå½“å‰ç›®å½•æ–‡ä»¶æ ‘ <prefix> + Tab 
set -g @plugin 'tmux-plugins/tmux-sidebar'

# æ˜¾ç¤ºå½“å‰ä¸»æœºæ˜¯å¦è”ç½‘ï¼ˆä»¥è¿é€šç™¾åº¦ä¸ºæ ‡å‡†ï¼‰
set -g @plugin 'QiangZiBro/tmux-online-status-cn'
# å¦‚æœå›¾æ ‡ä¸æ˜¾ç¤ºåˆ™ç”¨ä¸‹é¢ä¸¤ä¸ªä»£æ›¿
#set -g @online_icon "ok"
#set -g @offline_icon "offline!"

# æ˜¾ç¤ºcpuä¿¡æ¯ https://github.com/tmux-plugins/tmux-cpu
set -g @plugin 'QiangZiBro/tmux-cpu'
# å¯¹tmux cpuå†™äº†ä¸€ä¸ªé…ç½®ï¼Œè§‰å¾—æ²¡æœ‰å¿…è¦é‚£ä¹ˆèŠ±å“¨ï¼Œå°±çœå»äº†
#set -g @cpu_low_icon "ğŸ˜„" # icon when cpu is low
#set -g @cpu_medium_icon "ğŸ˜" # icon when cpu is medium
#set -g @cpu_high_icon "ğŸ¥µ" # icon when cpu is high
#set -g @cpu_low_fg_color "" # foreground color when cpu is low
#set -g @cpu_medium_fg_color "" # foreground color when cpu is medium
#set -g @cpu_high_fg_color "" # foreground color when cpu is high
#set -g @cpu_low_bg_color "#[bg=green]" # background color when cpu is low
#set -g @cpu_medium_bg_color "#[bg=yellow]" # background color when cpu is medium
#set -g @cpu_high_bg_color "#[bg=red]" # background color when cpu is high
#set -g @cpu_percentage_format "%3.1f%%" # printf format to use to display percentage
#set -g @cpu_medium_thresh "35" # medium percentage threshold
#set -g @cpu_high_thresh "80" # high percentage threshold
set-option -g status-right-length 90

# è·å–å„ç§ç³»ç»Ÿä¿¡æ¯çš„æ’ä»¶ã€CPUå’ŒMEMæœ‰BUGã€‘
set -g @plugin 'samoshkin/tmux-plugin-sysstat'
# tmux-plugin-sysstatä¾‹å­
#set -g status-right "#{sysstat_cpu} | #{sysstat_mem} | #{sysstat_swap} | #{sysstat_loadavg} | #[fg=cyan]#(echo $USER)#[default]@#H"
#set -g status-right "CPU:#{cpu_percentage} | #{sysstat_mem} | #{sysstat_swap} | #{sysstat_loadavg} | #[fg=cyan]#(echo $USER)#[default]@#H"

set -g status-bg green
set -g status-fg white


# æ‰¾åˆ°ä¸»æœºå(hostname)
set -g @tpm_plugins "                 \
  tmux-plugins/tpm                    \
  soyuka/tmux-current-pane-hostname     \
"
# '#[fg=cyan,bold] #U@#H #[default]#[fg=blue]#(tmux display-message -p "#{pane_current_path}" | sed "s#$HOME#~#g") #[fg=red]%H:%M %d-%b-%y#[default]'


# çŠ¶æ€æ è®¾å®š
# æ··åˆtmux-cpuå’Œtmux-plugin-sysstat
set -g status-right "#{prefix_highlight}#{online_status}|\
CPU:#{cpu_percentage}|GPU:#{gpu_percentage}|\
#{sysstat_loadavg}|\
%H:%M #H"

#-------------------------------------------------
# æ–­ ç”µ å…‹ æ˜Ÿ
#-------------------------------------------------
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
# 1. [é»˜è®¤]æ¯éš”15åˆ†é’Ÿè‡ªåŠ¨ä¿å­˜ï¼Œå½“ç„¶ä½ å¯ä»¥è¿æŒ‰ä¸¤æ¬¡<prefix>é”®æ‰‹åŠ¨ä¿å­˜
# 2. [éœ€è¦è®¾ç½®]é€šç”µåè‡ªåŠ¨æ‰“å¼€tmux
# 3. å¼€å¯tmuxåè‡ªåŠ¨æ¢å¤ä¸Šä¸€ä¸ªä¿å­˜çš„ç¯å¢ƒ
set -g @continuum-restore 'on'
# 4.ä¿å­˜ç»ˆç«¯é‡Œçš„å†…å®¹
set -g @resurrect-capture-pane-contents 'on'
# 5.for vim
set -g @resurrect-strategy-vim 'session'
# 6.for neovim
set -g @resurrect-strategy-nvim 'session'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# EOF
